jQuery.noConflict(),function(e,t){"use strict";const o="__NONE__",c="指定しない",n="QRチェックイン",l=document.getElementById("form_settings"),i={},a={},d={},_=kintone.plugin.app.getConfig(t),u=(e,t,o)=>e.hasOwnProperty(t)?e[t]:o,s=u(_,"label_datetime_checkin",""),m=u(_,"label_datetime_checkout",""),r=(u(_,"label_lookup_memberid",""),u(_,"checkbox_show_button_close","true")),k=u(_,"checkbox_close_on_dblclick","true"),p=u(_,"checkbox_close_on_multi_tap","true"),b=(u(_,"title_dialog",n),()=>{const e=document.getElementById("form_settings"),t=e.label_datetime_checkout.value,o=e.radio_checkinstyle.value,n=document.getElementById("btn_apply");let l="";t==c&&"transaction"==o?(n.disabled=!0,n.className="kintoneplugin-button-disabled",l="🚫 Handshake modeではチェックアウトフィールドの指定が必須です。"):(n.disabled=!1,n.className="kintoneplugin-button-dialog-ok"),document.getElementById("msg_submitarea").textContent=l});a["指定しない"]=o;const h=document.getElementById("label_datetime_checkout"),g=document.createElement("option");g.textContent=c,g.setAttribute("name",o),h.appendChild(g),h.addEventListener("change",b,!1),l.radio_checkinstyle.value=u(_,"radio_checkinstyle","transaction"),document.getElementById("div_radio_checkinstyle").addEventListener("change",b,!1),l.title_dialog.value=u(_,"title_dialog",n),l.number_guard_millisecond.value=u(_,"number_guard_millisecond","1000"),l.checkbox[0].checked="true"==r,l.checkbox[1].checked="true"==k,l.checkbox[2].checked="true"==p,kintone.api(kintone.api.url("/k/v1/app/form/fields",!0),"GET",{app:kintone.app.getId()},(function(t){for(const o in t.properties){if(!t.properties.hasOwnProperty(o))continue;const c=t.properties[o],n=c.label,l=c.code,_=c.type;if(i[l]={code:l,label:n,type:_},"DATETIME"===c.type){a[c.label]=c.code;const t=(e=>e==s?" selected":"")(n),o=(e=>e==m?" selected":"")(n);e("#label_datetime_checkin").append("<option name="+l+"".concat(t,">")+n+"</option>"),e("#label_datetime_checkout").append("<option name="+l+"".concat(o,">")+n+"</option>")}else c.hasOwnProperty("lookup")&&(d[c.label]=c.code,e("#label_lookup_memberid").append("<option name="+l+">"+n+"</option>"))}b()}));const f=e(".js-submit-settings"),y=e(".js-cancel-button");f.on("submit",(function(e){const t={},c=document.getElementById("form_settings");t.label_datetime_checkin=c.label_datetime_checkin.value,t.fc_datetime_checkin=a[c.label_datetime_checkin.value],t.label_datetime_checkout=c.label_datetime_checkout.value,t.fc_datetime_checkout=a[c.label_datetime_checkout.value],t.label_lookup_memberid=c.label_lookup_memberid.value,t.fc_lookup_memberid=d[c.label_lookup_memberid.value],t.radio_checkinstyle=c.radio_checkinstyle.value,t.number_guard_millisecond=c.number_guard_millisecond.value,t.title_dialog=c.title_dialog.value,t.checkbox_show_button_close=1==c.checkbox[0].checked?"true":"false",t.checkbox_close_on_dblclick=1==c.checkbox[1].checked?"true":"false",t.checkbox_close_on_multi_tap=1==c.checkbox[2].checked?"true":"false",t.fc_datetime_checkout==o&&"transaction"==t.radio_checkinstyle?alert("保存できません。双方向チェックスタイルではチェックアウトフィールドを指定してください。"):(e.preventDefault(),kintone.plugin.app.setConfig(t,(function(){alert("プラグイン設定を保存しました。アプリの更新をお忘れなく！"),window.location.href="../../flow?app="+kintone.app.getId()})))})),y.on("click",(function(){window.location.href="../../"+kintone.app.getId()+"/plugin/"}))}(jQuery,kintone.$PLUGIN_ID);